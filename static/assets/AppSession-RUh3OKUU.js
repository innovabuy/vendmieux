import{u as I,a as L,j as e,T as w}from"./index-DsKapFh0.js";import{e as D,d as E,b as S,L as C}from"./vendor-3wlXGvqm.js";import{u as T,B as R}from"./shared-H3sPg6Da.js";const B={accroche:"Accroche",decouverte:"Découverte",creation_enjeu:"Création d'enjeu",argumentation:"Argumentation",traitement_objections:"Objections",engagement:"Engagement"},g=Object.keys(B);function W(t){return t>=16?"A":t>=13?"B":t>=10?"C":t>=7?"D":"E"}function M(t,i){return{A:i.ok,B:i.bl,C:i.wr,D:i.ac,E:i.dn}[t]||i.mt}function $({competences:t,size:i=180,c:p}){const x=i/2,n=i/2,f=i/2-24,y=g.length,m=2*Math.PI/y,h=(r,l)=>{const s=-Math.PI/2+r*m,o=l/20*f;return[x+o*Math.cos(s),n+o*Math.sin(s)]},j=g.map((r,l)=>{var s;return h(l,((s=t[r])==null?void 0:s.score)||0).join(",")}).join(" ");return e.jsxs("svg",{width:i,height:i,viewBox:`0 0 ${i} ${i}`,children:[[.5,1].map(r=>e.jsx("polygon",{points:g.map((l,s)=>{const o=-Math.PI/2+s*m,c=r*f;return`${x+c*Math.cos(o)},${n+c*Math.sin(o)}`}).join(" "),fill:"none",stroke:p.bd,strokeWidth:.5},r)),e.jsx("polygon",{points:j,fill:`${p.ac}22`,stroke:p.ac,strokeWidth:2}),g.map((r,l)=>{var c;const[s,o]=h(l,((c=t[r])==null?void 0:c.score)||0);return e.jsx("circle",{cx:s,cy:o,r:3,fill:p.ac},r)}),g.map((r,l)=>{const s=-Math.PI/2+l*m,o=f+16,c=x+o*Math.cos(s),a=n+o*Math.sin(s);return e.jsx("text",{x:c,y:a,textAnchor:"middle",dominantBaseline:"middle",fill:p.mt,fontSize:8,children:B[r]},r)})]})}function V(){var c;const t=T(),{user:i}=I(),{id:p}=D(),x=E(),[n,f]=S.useState(null),[y,m]=S.useState(!0);if(S.useEffect(()=>{if(!i){x("/app/login");return}L(`/api/dashboard/session/${p}`).then(a=>{if(!a.ok)throw new Error;return a.json()}).then(f).catch(()=>x("/app/dashboard")).finally(()=>m(!1))},[p,i]),y)return e.jsx("div",{style:{minHeight:"100vh",background:t.bg,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("span",{style:{color:t.mt},children:"Chargement..."})});if(!n)return null;const h=n.evaluation||{},j=h.competences||{},r=n.score_global||0,l=W(r),s=M(l,t),o={background:t.bgC,border:`1px solid ${t.bd}`,borderRadius:14,padding:20,marginBottom:16};return e.jsxs("div",{style:{minHeight:"100vh",background:t.bg,color:t.tx},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"14px 24px",borderBottom:`1px solid ${t.bd}`,background:`${t.bg}E0`,backdropFilter:"blur(12px)",position:"sticky",top:0,zIndex:100},children:[e.jsx(C,{to:"/app/dashboard",style:{display:"flex",alignItems:"center",gap:8,textDecoration:"none",color:t.mt,fontSize:13},children:"← Dashboard"}),e.jsx(w,{})]}),e.jsxs("div",{style:{maxWidth:800,margin:"0 auto",padding:"32px 20px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,marginBottom:24},children:[e.jsx("div",{style:{width:56,height:56,borderRadius:14,background:`${s}22`,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("span",{style:{fontSize:24,fontWeight:800,color:s},children:l})}),e.jsxs("div",{children:[e.jsxs("h1",{style:{margin:0,fontSize:20,fontWeight:700},children:["Session #",n.id]}),e.jsxs("div",{style:{fontSize:13,color:t.mt,marginTop:2},children:[n.scenario_id==="__default__"?"Olivier Bertrand — Industrie":n.scenario_id," · ","Difficulté ","*".repeat(n.difficulty||2),n.created_at&&" · "+new Date(n.created_at).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})]})]}),e.jsxs("div",{style:{marginLeft:"auto",textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:28,fontWeight:800,color:s},children:[r,"/20"]}),e.jsx("div",{style:{fontSize:11,color:t.mt},children:h.resultat_appel||""})]})]}),h.synthese&&e.jsxs("div",{style:{...o,borderLeftWidth:3,borderLeftColor:t.ac},children:[e.jsx("div",{style:{fontSize:10,fontWeight:700,letterSpacing:1,color:t.mt,textTransform:"uppercase",marginBottom:8},children:"Synthèse"}),e.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6},children:h.synthese}),h.conseil_prioritaire&&e.jsxs("div",{style:{marginTop:12,padding:"10px 14px",borderRadius:8,background:t.acD,fontSize:13},children:[e.jsx("strong",{children:"Conseil prioritaire :"})," ",h.conseil_prioritaire]})]}),e.jsx("div",{style:{display:"flex",gap:16,flexWrap:"wrap",marginBottom:16},children:e.jsx("div",{style:{...o,flex:"1 1 200px",display:"flex",justifyContent:"center",marginBottom:0},children:e.jsx($,{competences:j,c:t})})}),g.map(a=>{var z,k;const d=j[a];if(!d)return null;const u=d.score||0,_=W(u),A=M(_,t);return e.jsxs("div",{style:o,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[e.jsx("span",{style:{fontSize:14,fontWeight:600},children:B[a]}),e.jsxs("span",{style:{fontSize:16,fontWeight:800,color:A},children:[u,"/20 ",e.jsx("span",{style:{fontSize:12,fontWeight:600},children:_})]})]}),((z=d.points_forts)==null?void 0:z.length)>0&&e.jsxs("div",{style:{marginBottom:10},children:[e.jsx("div",{style:{fontSize:11,fontWeight:600,color:t.ok,marginBottom:4},children:"Points forts"}),d.points_forts.map((v,b)=>e.jsxs("div",{style:{fontSize:13,color:t.tx,lineHeight:1.5,marginBottom:2,paddingLeft:12,position:"relative"},children:[e.jsx("span",{style:{position:"absolute",left:0,color:t.ok},children:"+"}),v]},b))]}),((k=d.points_progres)==null?void 0:k.length)>0&&e.jsxs("div",{style:{marginBottom:10},children:[e.jsx("div",{style:{fontSize:11,fontWeight:600,color:t.dn,marginBottom:4},children:"Axes de progrès"}),d.points_progres.map((v,b)=>e.jsxs("div",{style:{fontSize:13,color:t.tx,lineHeight:1.5,marginBottom:2,paddingLeft:12,position:"relative"},children:[e.jsx("span",{style:{position:"absolute",left:0,color:t.dn},children:"-"}),v]},b))]}),d.conseil&&e.jsx("div",{style:{padding:"8px 12px",borderRadius:8,background:t.bgE,fontSize:12,color:t.mt,lineHeight:1.5},children:d.conseil})]},a)}),((c=n.transcript)==null?void 0:c.length)>0&&e.jsxs("div",{style:o,children:[e.jsx("div",{style:{fontSize:10,fontWeight:700,letterSpacing:1,color:t.mt,textTransform:"uppercase",marginBottom:12},children:"Transcript intégral"}),n.transcript.map((a,d)=>{const u=a.role==="vendeur";return e.jsxs("div",{style:{display:"flex",gap:10,marginBottom:8},children:[e.jsx("div",{style:{width:60,flexShrink:0,textAlign:"right"},children:e.jsx(R,{color:u?"blue":"accent",children:u?"Vendeur":"Prospect"})}),e.jsx("div",{style:{fontSize:13,lineHeight:1.6,flex:1},children:a.text})]},d)})]}),n.brief&&e.jsxs("div",{style:o,children:[e.jsx("div",{style:{fontSize:10,fontWeight:700,letterSpacing:1,color:t.mt,textTransform:"uppercase",marginBottom:12},children:"Brief commercial"}),e.jsxs("div",{style:{fontSize:13,lineHeight:1.6,color:t.mt},children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Titre :"})," ",n.brief.titre]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Vous êtes :"})," ",n.brief.vous_etes]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Vous vendez :"})," ",n.brief.vous_vendez]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Vous appelez :"})," ",n.brief.vous_appelez]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Objectif :"})," ",n.brief.votre_objectif]})]})]}),e.jsx("div",{style:{textAlign:"center",marginTop:20},children:e.jsx(C,{to:"/app/dashboard",style:{fontSize:13,color:t.ac,textDecoration:"none"},children:"← Retour au dashboard"})})]})]})}export{V as default};
